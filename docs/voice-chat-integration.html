<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Voice &amp; Chat Integration | Engram - Context Engineering Platform</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Voice &amp; Chat Integration" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Enterprise AI Memory &amp; Cognition Platform" />
<meta property="og:description" content="Enterprise AI Memory &amp; Cognition Platform" />
<link rel="canonical" href="https://wiki.engram.work/voice-chat-integration.html" />
<meta property="og:url" content="https://wiki.engram.work/voice-chat-integration.html" />
<meta property="og:site_name" content="Engram - Context Engineering Platform" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Voice &amp; Chat Integration" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Enterprise AI Memory &amp; Cognition Platform","headline":"Voice &amp; Chat Integration","url":"https://wiki.engram.work/voice-chat-integration.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1><a href="https://wiki.engram.work/">Engram - Context Engineering Platform</a></h1>

        

        <p>Enterprise AI Memory & Cognition Platform</p>

        

        

        
      </header>
      <section>

      <h1 id="home--voice--chat-integration"><a href="/">Home</a> › Voice &amp; Chat Integration</h1>

<h1 id="voice--chat-integration-guide">Voice &amp; Chat Integration Guide</h1>

<p>Engram provides two integrated communication channels for interacting with AI agents:</p>

<table>
  <thead>
    <tr>
      <th>Channel</th>
      <th>Endpoint</th>
      <th>Model</th>
      <th>Auth</th>
      <th>Use Case</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Chat</strong></td>
      <td>API Gateway</td>
      <td>gpt-5.1-chat</td>
      <td>API Key</td>
      <td>Text-based conversations</td>
    </tr>
    <tr>
      <td><strong>Voice</strong></td>
      <td>Azure AI Services</td>
      <td>gpt-realtime</td>
      <td>DefaultAzureCredential</td>
      <td>Real-time voice interactions</td>
    </tr>
  </tbody>
</table>

<h2 id="security-model-nist-ai-rmf-compliant">Security Model (NIST AI RMF Compliant)</h2>

<table>
  <thead>
    <tr>
      <th>Level</th>
      <th>Environment</th>
      <th>Chat Auth</th>
      <th>VoiceLive Auth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1-2</td>
      <td>POC/Staging</td>
      <td>API Key (APIM)</td>
      <td>Azure CLI / DefaultAzureCredential</td>
    </tr>
    <tr>
      <td>3-5</td>
      <td>Production/Enterprise</td>
      <td>API Key (APIM)</td>
      <td>Managed Identity (DefaultAzureCredential)</td>
    </tr>
  </tbody>
</table>

<p><strong>DefaultAzureCredential</strong> automatically selects the best credential for each environment:</p>

<ul>
  <li><strong>Local Dev</strong>: Azure CLI (<code class="language-plaintext highlighter-rouge">az login</code>)</li>
  <li><strong>Azure Container Apps</strong>: Managed Identity</li>
  <li><strong>AKS</strong>: Workload Identity</li>
  <li><strong>VMs</strong>: System-assigned Managed Identity</li>
</ul>

<hr />

<h2 id="chat-integration-api-gateway">Chat Integration (API Gateway)</h2>

<h3 id="configuration">Configuration</h3>

<p>The chat system uses an OpenAI-compatible API gateway for text-based agent interactions.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Environment Variables</span>
<span class="nv">AZURE_AI_ENDPOINT</span><span class="o">=</span>https://zimax-gw.azure-api.net/zimax/openai/v1
<span class="nv">AZURE_AI_KEY</span><span class="o">=</span>&lt;your-api-key&gt;
<span class="nv">AZURE_AI_DEPLOYMENT</span><span class="o">=</span>gpt-5.1-chat
</code></pre></div></div>

<h3 id="api-endpoints">API Endpoints</h3>

<h4 id="rest-chat-single-turn">REST Chat (Single Turn)</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /api/v1/chat
Content-Type: application/json

<span class="o">{</span>
  <span class="s2">"content"</span>: <span class="s2">"What are the key requirements for this project?"</span>,
  <span class="s2">"agent_id"</span>: <span class="s2">"elena"</span>,
  <span class="s2">"session_id"</span>: <span class="s2">"optional-session-id"</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Response:</strong></p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"message_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uuid"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"content"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Based on my analysis..."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"agent_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"elena"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"agent_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Dr. Elena Vasquez"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2025-12-15T10:30:00Z"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"session_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"session-123"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h4 id="websocket-chat-streaming">WebSocket Chat (Streaming)</h4>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Connect to streaming chat</span>
<span class="kd">const</span> <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">WebSocket</span><span class="p">(</span><span class="dl">'</span><span class="s1">ws://localhost:8082/api/v1/chat/ws/session-123</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// Send message</span>
<span class="nx">ws</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">({</span>
  <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">content</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Analyze project risks</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">agent_id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">marcus</span><span class="dl">'</span>
<span class="p">}));</span>

<span class="c1">// Receive streaming response</span>
<span class="nx">ws</span><span class="p">.</span><span class="nx">onmessage</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
  <span class="k">switch </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="dl">'</span><span class="s1">typing</span><span class="dl">'</span><span class="p">:</span>
      <span class="c1">// Agent is typing</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="dl">'</span><span class="s1">chunk</span><span class="dl">'</span><span class="p">:</span>
      <span class="c1">// Append text chunk: data.content</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="dl">'</span><span class="s1">complete</span><span class="dl">'</span><span class="p">:</span>
      <span class="c1">// Response finished: data.message_id</span>
      <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="agents">Agents</h3>

<table>
  <thead>
    <tr>
      <th>Agent</th>
      <th>ID</th>
      <th>Expertise</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Elena</strong></td>
      <td><code class="language-plaintext highlighter-rouge">elena</code></td>
      <td>Business Analysis, Requirements Engineering</td>
    </tr>
    <tr>
      <td><strong>Marcus</strong></td>
      <td><code class="language-plaintext highlighter-rouge">marcus</code></td>
      <td>Project Management, Risk Assessment</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="voicelive-integration-real-time-voice">VoiceLive Integration (Real-time Voice)</h2>

<h3 id="configuration-1">Configuration</h3>

<p>VoiceLive provides real-time speech-to-speech conversations using Azure AI Services with <strong>NIST AI RMF compliant authentication</strong>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Environment Variables</span>
<span class="nv">AZURE_VOICELIVE_ENDPOINT</span><span class="o">=</span>https://zimax.services.ai.azure.com
<span class="nv">AZURE_VOICELIVE_MODEL</span><span class="o">=</span>gpt-realtime
<span class="nv">AZURE_VOICELIVE_VOICE</span><span class="o">=</span>en-US-Ava:DragonHDLatestNeural
<span class="nv">MARCUS_VOICELIVE_VOICE</span><span class="o">=</span>en-US-GuyNeural

<span class="c"># Optional: API key for POC/staging (not needed if using Azure CLI or Managed Identity)</span>
<span class="c"># AZURE_VOICELIVE_KEY=&lt;optional-for-poc-only&gt;</span>
</code></pre></div></div>

<h3 id="authentication">Authentication</h3>

<p>VoiceLive uses <code class="language-plaintext highlighter-rouge">DefaultAzureCredential</code> which automatically selects the appropriate credential:</p>

<table>
  <thead>
    <tr>
      <th>Environment</th>
      <th>Credential Used</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Local Development</td>
      <td>Azure CLI (<code class="language-plaintext highlighter-rouge">az login</code>)</td>
    </tr>
    <tr>
      <td>Azure Container Apps</td>
      <td>Managed Identity</td>
    </tr>
    <tr>
      <td>Azure Kubernetes Service</td>
      <td>Workload Identity</td>
    </tr>
    <tr>
      <td>Azure VMs</td>
      <td>System Managed Identity</td>
    </tr>
    <tr>
      <td>GitHub Actions</td>
      <td>Federated Identity</td>
    </tr>
  </tbody>
</table>

<p><strong>Enterprise (Level 3-5)</strong>: Managed Identity is required - no API keys in production.</p>

<h3 id="api-endpoints-1">API Endpoints</h3>

<h4 id="voice-configuration">Voice Configuration</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /api/v1/voice/config/<span class="o">{</span>agent_id<span class="o">}</span>
</code></pre></div></div>

<p><strong>Response:</strong></p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"agent_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"elena"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"voice_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en-US-Ava:DragonHDLatestNeural"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"model"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gpt-realtime"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"endpoint_configured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h4 id="voice-status">Voice Status</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /api/v1/voice/status
</code></pre></div></div>

<p><strong>Response:</strong></p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"voicelive_configured"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"endpoint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://zimax.services.ai.azure.com..."</span><span class="p">,</span><span class="w">
  </span><span class="nl">"model"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gpt-realtime"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"active_sessions"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="nl">"agents"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"elena"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nl">"voice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en-US-Ava:DragonHDLatestNeural"</span><span class="p">},</span><span class="w">
    </span><span class="nl">"marcus"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nl">"voice"</span><span class="p">:</span><span class="w"> </span><span class="s2">"en-US-GuyNeural"</span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h4 id="voicelive-websocket-real-time-audio">VoiceLive WebSocket (Real-time Audio)</h4>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Connect to VoiceLive</span>
<span class="kd">const</span> <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">WebSocket</span><span class="p">(</span><span class="dl">'</span><span class="s1">ws://localhost:8082/api/v1/voice/voicelive/session-123</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">ws</span><span class="p">.</span><span class="nx">onopen</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="c1">// Set agent</span>
  <span class="nx">ws</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">agent</span><span class="dl">'</span><span class="p">,</span> <span class="na">agent_id</span><span class="p">:</span> <span class="dl">'</span><span class="s1">elena</span><span class="dl">'</span> <span class="p">}));</span>
<span class="p">};</span>

<span class="c1">// Send audio (PCM16, 24kHz, mono)</span>
<span class="kd">function</span> <span class="nf">sendAudio</span><span class="p">(</span><span class="nx">pcm16Base64</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">ws</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">audio</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">pcm16Base64</span>
  <span class="p">}));</span>
<span class="p">}</span>

<span class="c1">// Switch agent mid-conversation</span>
<span class="kd">function</span> <span class="nf">switchAgent</span><span class="p">(</span><span class="nx">agentId</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">ws</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">agent</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">agent_id</span><span class="p">:</span> <span class="nx">agentId</span>  <span class="c1">// 'elena' or 'marcus'</span>
  <span class="p">}));</span>
<span class="p">}</span>

<span class="c1">// Cancel current response</span>
<span class="kd">function</span> <span class="nf">cancelResponse</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">ws</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">cancel</span><span class="dl">'</span> <span class="p">}));</span>
<span class="p">}</span>

<span class="c1">// Handle responses</span>
<span class="nx">ws</span><span class="p">.</span><span class="nx">onmessage</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
  <span class="k">switch </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="dl">'</span><span class="s1">transcription</span><span class="dl">'</span><span class="p">:</span>
      <span class="c1">// data.status: 'listening' | 'processing' | 'complete'</span>
      <span class="c1">// data.text: transcribed text (when complete)</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="dl">'</span><span class="s1">audio</span><span class="dl">'</span><span class="p">:</span>
      <span class="c1">// data.data: base64 audio response</span>
      <span class="c1">// data.format: 'audio/pcm16'</span>
      <span class="nf">playAudio</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="dl">'</span><span class="s1">agent_switched</span><span class="dl">'</span><span class="p">:</span>
      <span class="c1">// data.agent_id: new active agent</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">case</span> <span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">:</span>
      <span class="c1">// data.message: error description</span>
      <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="audio-format-requirements">Audio Format Requirements</h3>

<table>
  <thead>
    <tr>
      <th>Property</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Format</td>
      <td>PCM16 (signed 16-bit)</td>
    </tr>
    <tr>
      <td>Sample Rate</td>
      <td>24,000 Hz (Required for low-latency)</td>
    </tr>
    <tr>
      <td>Channels</td>
      <td>Mono (1 channel)</td>
    </tr>
    <tr>
      <td>Encoding</td>
      <td>Base64</td>
    </tr>
    <tr>
      <td>Chunk Size</td>
      <td>1200 samples (50ms)</td>
    </tr>
  </tbody>
</table>

<h3 id="memory-enrichment">Memory Enrichment</h3>

<p>The Voice system integrates with memory in two directions:</p>

<h4 id="1-pre-session-context-read">1. Pre-Session Context (Read)</h4>

<p>Upon connection, the system retrieves up to <strong>20 relevant facts</strong> from the user’s Zep memory graph and injects them into the Agent’s system instructions. This gives the agent awareness of the user’s context (role, current projects, past conversations).</p>

<h4 id="2-post-session-persistence-write--v2-architecture">2. Post-Session Persistence (Write) — v2 Architecture</h4>

<blockquote>
  <p>[!NOTE]
VoiceLive v2 decouples audio streaming from memory enrichment. See <a href="/sop/voicelive-configuration.md#future-architecture-voicelive-v2-decoupled">VoiceLive Configuration SOP</a> for details.</p>
</blockquote>

<p>In the evolved architecture:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Browser: On receiving final transcript</span>
<span class="nx">ws</span><span class="p">.</span><span class="nx">onmessage</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
  <span class="k">if </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">transcription</span><span class="dl">'</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">status</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">complete</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Async fire-and-forget to memory</span>
    <span class="nf">fetch</span><span class="p">(</span><span class="dl">'</span><span class="s1">/api/v1/memory/enrich</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">method</span><span class="p">:</span> <span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">headers</span><span class="p">:</span> <span class="p">{</span> <span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span> <span class="p">},</span>
      <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nf">stringify</span><span class="p">({</span>
        <span class="na">text</span><span class="p">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">text</span><span class="p">,</span>
        <span class="na">session_id</span><span class="p">:</span> <span class="nx">sessionId</span><span class="p">,</span>
        <span class="na">speaker</span><span class="p">:</span> <span class="nx">data</span><span class="p">.</span><span class="nx">speaker</span><span class="p">,</span>  <span class="c1">// 'user' or 'assistant'</span>
        <span class="na">agent_id</span><span class="p">:</span> <span class="nx">currentAgentId</span>
      <span class="p">})</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<p><strong>Key principle</strong>: Audio playback happens immediately. Memory enrichment flows behind it asynchronously. If memory persistence fails, the voice experience is unaffected.</p>

<h3 id="voice-personalities">Voice Personalities</h3>

<table>
  <thead>
    <tr>
      <th>Agent</th>
      <th>Voice</th>
      <th>Personality</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Elena</strong></td>
      <td>en-US-Ava:DragonHDLatestNeural</td>
      <td>Warm, measured, professional</td>
    </tr>
    <tr>
      <td><strong>Marcus</strong></td>
      <td>en-US-GuyNeural</td>
      <td>Confident, energetic, direct</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="frontend-integration">Frontend Integration</h2>

<h3 id="voicechat-component">VoiceChat Component</h3>

<p>The frontend includes a ready-to-use <code class="language-plaintext highlighter-rouge">VoiceChat</code> component:</p>

<div class="language-tsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">VoiceChat</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./components/VoiceChat</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">function</span> <span class="nf">App</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return </span><span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">VoiceChat</span>
      <span class="na">agentId</span><span class="p">=</span><span class="s">"elena"</span>
      <span class="na">onMessage</span><span class="p">=</span><span class="si">{</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Voice message:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">msg</span><span class="p">)</span><span class="si">}</span>
      <span class="na">onVisemes</span><span class="p">=</span><span class="si">{</span><span class="p">(</span><span class="nx">visemes</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="cm">/* Lip-sync data */</span><span class="si">}</span>
      <span class="na">onStatusChange</span><span class="p">=</span><span class="si">{</span><span class="p">(</span><span class="nx">status</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">Status:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">status</span><span class="p">)</span><span class="si">}</span>
    <span class="p">/&gt;</span>
  <span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="push-to-talk-usage">Push-to-Talk Usage</h3>

<ol>
  <li><strong>Hold</strong> the voice button to speak</li>
  <li><strong>Release</strong> to send audio</li>
  <li>Agent responds with synthesized speech</li>
  <li>Switch agents anytime during conversation</li>
</ol>

<hr />

<h2 id="local-development">Local Development</h2>

<h3 id="start-backend">Start Backend</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>backend

<span class="c"># Set environment variables (or use .env file)</span>
<span class="nb">export </span><span class="nv">AZURE_AI_ENDPOINT</span><span class="o">=</span>https://zimax-gw.azure-api.net/zimax/openai/v1
<span class="nb">export </span><span class="nv">AZURE_AI_KEY</span><span class="o">=</span>&lt;your-key&gt;
<span class="nb">export </span><span class="nv">AZURE_AI_DEPLOYMENT</span><span class="o">=</span>gpt-5.1-chat
<span class="nb">export </span><span class="nv">AZURE_VOICELIVE_ENDPOINT</span><span class="o">=</span>https://zimax.services.ai.azure.com
<span class="nb">export </span><span class="nv">AZURE_VOICELIVE_KEY</span><span class="o">=</span>&lt;your-key&gt;
<span class="nb">export </span><span class="nv">AZURE_VOICELIVE_MODEL</span><span class="o">=</span>gpt-realtime

<span class="c"># Start server</span>
uvicorn backend.api.main:app <span class="nt">--host</span> 0.0.0.0 <span class="nt">--port</span> 8082 <span class="nt">--reload</span>
</code></pre></div></div>

<h3 id="start-frontend">Start Frontend</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd </span>frontend
<span class="nb">export </span><span class="nv">VITE_API_URL</span><span class="o">=</span>http://localhost:8082
<span class="nb">export </span><span class="nv">VITE_WS_URL</span><span class="o">=</span>ws://localhost:8082
npm run dev
</code></pre></div></div>

<h3 id="test-chat">Test Chat</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-X</span> POST http://localhost:8082/api/v1/chat <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  <span class="nt">-d</span> <span class="s1">'{"content": "Hello Elena!", "agent_id": "elena"}'</span>
</code></pre></div></div>

<h3 id="test-voice-status">Test Voice Status</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl http://localhost:8082/api/v1/voice/status
</code></pre></div></div>

<hr />

<h2 id="troubleshooting">Troubleshooting</h2>

<h3 id="chat-issues">Chat Issues</h3>

<table>
  <thead>
    <tr>
      <th>Issue</th>
      <th>Solution</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>401 Unauthorized</td>
      <td>Check <code class="language-plaintext highlighter-rouge">AZURE_AI_KEY</code> is set correctly</td>
    </tr>
    <tr>
      <td>Model not found</td>
      <td>Verify <code class="language-plaintext highlighter-rouge">AZURE_AI_DEPLOYMENT=gpt-5.1-chat</code></td>
    </tr>
    <tr>
      <td>Temperature error</td>
      <td>The gateway may not support custom temperature</td>
    </tr>
  </tbody>
</table>

<h3 id="voice-issues">Voice Issues</h3>

<table>
  <thead>
    <tr>
      <th>Issue</th>
      <th>Solution</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>“VoiceLive not configured”</td>
      <td>Set <code class="language-plaintext highlighter-rouge">AZURE_VOICELIVE_ENDPOINT</code> and <code class="language-plaintext highlighter-rouge">AZURE_VOICELIVE_KEY</code></td>
    </tr>
    <tr>
      <td>Connection failed</td>
      <td>Verify the endpoint supports real-time audio</td>
    </tr>
    <tr>
      <td>No audio response</td>
      <td>Check microphone permissions in browser</td>
    </tr>
  </tbody>
</table>

<h3 id="websocket-connection">WebSocket Connection</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Debug WebSocket connection</span>
<span class="nx">ws</span><span class="p">.</span><span class="nx">onerror</span> <span class="o">=</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">WebSocket error:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">error</span><span class="p">);</span>
<span class="nx">ws</span><span class="p">.</span><span class="nx">onclose</span> <span class="o">=</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">WebSocket closed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">code</span><span class="p">,</span> <span class="nx">event</span><span class="p">.</span><span class="nx">reason</span><span class="p">);</span>
</code></pre></div></div>

<hr />

<h2 id="related-documentation">Related Documentation</h2>

<ul>
  <li><a href="/architecture">Architecture</a> - Platform design and context schema</li>
  <li><a href="/agents">Agents</a> - Elena and Marcus agent details</li>
  <li><a href="/LOCAL-TESTING-GUIDE">Local Testing Guide</a> - Development setup</li>
</ul>


      </section>
      <footer>
        
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="/assets/js/scale.fix.js"></script>
  </body>
</html>
